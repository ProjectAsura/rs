//-----------------------------------------------------------------------------
// File : rsJob.h
// Desc : Rendering Job
// Copyright(c) Project Asura. All right reserved.
//-----------------------------------------------------------------------------
#pragma once


namespace rs {

///////////////////////////////////////////////////////////////////////////////
// Job class
///////////////////////////////////////////////////////////////////////////////
class Job : public IJob
{
    //=========================================================================
    // list of friend classes and methods.
    //=========================================================================
    /* NOTHING */

public:
    //=========================================================================
    // public variables.
    //=========================================================================
    /* NOTHING */

    //=========================================================================
    // pubilc methods.
    //=========================================================================

    //-------------------------------------------------------------------------
    //! @brief      コンストラクタです.
    //-------------------------------------------------------------------------
    Job() = default;

    //-------------------------------------------------------------------------
    //! @brief      引数付きコンストラクタです.
    //! 
    //! @param[in]      begin       開始パスです.
    //! @param[in]      end         終了パスです.
    //-------------------------------------------------------------------------
    Job(PassGraph* pGraph, Pass* begin, Pass* end, a3d::ICommandList* pCommandList);

    //-------------------------------------------------------------------------
    //! @brief      デストラクタです.
    //-------------------------------------------------------------------------
    ~Job() = default;

    //-------------------------------------------------------------------------
    //! @brief      処理を実行します.
    //-------------------------------------------------------------------------
    void Execute() override;

    //-------------------------------------------------------------------------
    //! @brief      処理完了済みかどうかチェックします.
    //-------------------------------------------------------------------------
    bool IsFinished() const;

private:
    //=========================================================================
    // private variables.
    //=========================================================================
    PassGraph*          m_pGraph        = nullptr;
    Pass*               m_pBegin        = nullptr;
    Pass*               m_pEnd          = nullptr;
    a3d::ICommandList*  m_pCommandList  = nullptr;
    std::atomic<bool>   m_IsFinished    = false;

    //=========================================================================
    // private methods.
    //=========================================================================
    /* NOTHING */
};

} // namespace rs
